diff --git a/dist/module.mjs b/dist/module.mjs
index cb0df587e07404f133284b5f8d94c2a9ac46e000..e0f9ff0505a5b4ec6a5a29d68d615078521d4007 100644
--- a/dist/module.mjs
+++ b/dist/module.mjs
@@ -41,6 +41,9 @@ function resolveCacheConfig(hub) {
   if (!hub.cache) return false;
   const userConfig = typeof hub.cache === "object" ? hub.cache : {};
   if (userConfig.driver) {
+    if (userConfig.driver === "cloudflare-kv-binding") {
+      return defu(userConfig, { binding: "CACHE" });
+    }
     return userConfig;
   }
   if (hub.hosting.includes("cloudflare")) {
@@ -80,7 +83,7 @@ const log$4 = logger.withTag("nuxt:hub");
 const cloudflareHooks = createHooks();
 function setupCloudflare(nuxt, hub) {
   nuxt.options.nitro.cloudflare ||= {};
-  nuxt.options.nitro.cloudflare.nodeCompat = false;
+  nuxt.options.nitro.cloudflare.nodeCompat = true;
   nuxt.options.nitro.cloudflare.deployConfig = true;
   nuxt.options.nitro.prerender ||= {};
   nuxt.options.nitro.prerender.autoSubfolderIndex ||= false;
@@ -170,6 +173,21 @@ async function processWranglerConfigFile(nuxt, targetEnv) {
 }
 
 const log$3 = logger.withTag("nuxt:hub");
+function generateLazyDbTemplate(imports, getDbBody) {
+  return `${imports}
+import * as schema from './db/schema.mjs'
+
+let _db
+function getDb() {
+  if (!_db) {
+${getDbBody}
+  }
+  return _db
+}
+const db = new Proxy({}, { get(_, prop) { return getDb()[prop] } })
+export { db, schema }
+`;
+}
 async function resolveDatabaseConfig(nuxt, hub) {
   if (!hub.db) return false;
   let config = typeof hub.db === "string" ? { dialect: hub.db } : hub.db;
@@ -214,8 +232,8 @@ async function resolveDatabaseConfig(nuxt, hub) {
         break;
       }
       config.connection = defu(config.connection, { url: process.env.POSTGRES_URL || process.env.POSTGRESQL_URL || process.env.DATABASE_URL || "" });
-      if (config.driver && ["neon-http", "postgres-js"].includes(config.driver) && !config.connection.url) {
-        throw new Error(`\`${config.driver}\` driver requires \`DATABASE_URL\`, \`POSTGRES_URL\`, or \`POSTGRESQL_URL\` environment variable`);
+      if (config.applyMigrationsDuringBuild && config.driver && ["neon-http", "postgres-js"].includes(config.driver) && !config.connection.url) {
+        throw new Error(`\`${config.driver}\` driver requires \`DATABASE_URL\`, \`POSTGRES_URL\`, or \`POSTGRESQL_URL\` environment variable when \`applyMigrationsDuringBuild\` is enabled`);
       }
       if (config.connection.url) {
         config.driver ||= "postgres-js";
@@ -233,8 +251,8 @@ async function resolveDatabaseConfig(nuxt, hub) {
       }
       config.driver ||= "mysql2";
       config.connection = defu(config.connection, { uri: process.env.MYSQL_URL || process.env.DATABASE_URL || "" });
-      if (!config.connection.uri) {
-        throw new Error("MySQL requires DATABASE_URL or MYSQL_URL environment variable");
+      if (config.applyMigrationsDuringBuild && !config.connection.uri) {
+        throw new Error("MySQL requires DATABASE_URL or MYSQL_URL environment variable when `applyMigrationsDuringBuild` is enabled");
       }
       break;
     }
@@ -337,11 +355,9 @@ async function generateDatabaseSchema(nuxt, hub) {
     getContents: () => `${schemaPaths.map((path) => `export * from '${path}'`).join("\n")}`,
     write: true
   });
-  if (!nuxt.options._prepare) {
-    nuxt.hooks.hookOnce("app:templatesGenerated", async () => {
-      await buildDatabaseSchema(nuxt.options.buildDir, { relativeDir: nuxt.options.rootDir });
-    });
-  }
+  nuxt.hooks.hookOnce("app:templatesGenerated", async () => {
+    await buildDatabaseSchema(nuxt.options.buildDir, { relativeDir: nuxt.options.rootDir });
+  });
   nuxt.options.alias ||= {};
   nuxt.options.alias["hub:db:schema"] = join(nuxt.options.buildDir, "hub/db/schema.mjs");
   addTypeTemplate({
@@ -409,31 +425,23 @@ export { db, schema }
 `;
   }
   if (driver === "neon-http") {
-    drizzleOrmContent = `import { neon } from '@neondatabase/serverless'
-import { drizzle } from 'drizzle-orm/neon-http'
-import * as schema from './db/schema.mjs'
-
-const sql = neon('${connection.url}')
-const db = drizzle(sql, { schema${casingOption} })
-export { db, schema }
-`;
+    const urlExpr = connection.url ? `'${connection.url}'` : `process.env.POSTGRES_URL || process.env.POSTGRESQL_URL || process.env.DATABASE_URL`;
+    drizzleOrmContent = generateLazyDbTemplate(
+      `import { neon } from '@neondatabase/serverless'
+import { drizzle } from 'drizzle-orm/neon-http'`,
+      `    const url = ${urlExpr}
+    if (!url) throw new Error('DATABASE_URL, POSTGRES_URL, or POSTGRESQL_URL required')
+    const sql = neon(url)
+    _db = drizzle(sql, { schema${casingOption} })`
+    );
   }
   if (driver === "d1") {
-    drizzleOrmContent = `import { drizzle } from 'drizzle-orm/d1'
-import * as schema from './db/schema.mjs'
-
-let _db
-function getDb() {
-  if (!_db) {
-    const binding = process.env.DB || globalThis.__env__?.DB || globalThis.DB
+    drizzleOrmContent = generateLazyDbTemplate(
+      `import { drizzle } from 'drizzle-orm/d1'`,
+      `    const binding = process.env.DB || globalThis.__env__?.DB || globalThis.DB
     if (!binding) throw new Error('DB binding not found')
-    _db = drizzle(binding, { schema${casingOption} })
-  }
-  return _db
-}
-const db = new Proxy({}, { get(_, prop) { return getDb()[prop] } })
-export { db, schema }
-`;
+    _db = drizzle(binding, { schema${casingOption} })`
+    );
   }
   if (driver === "d1-http") {
     drizzleOrmContent = `import { drizzle } from 'drizzle-orm/sqlite-proxy'
@@ -490,23 +498,34 @@ const db = drizzle(d1HttpDriver, { schema${casingOption} })
 export { db, schema }
 `;
   }
-  if (["postgres-js", "mysql2"].includes(driver) && hub.hosting.includes("cloudflare")) {
+  if (["postgres-js", "mysql2"].includes(driver) && hub.hosting.includes("cloudflare") && connection?.hyperdriveId) {
     const bindingName = driver === "postgres-js" ? "POSTGRES" : "MYSQL";
-    drizzleOrmContent = `import { drizzle } from 'drizzle-orm/${driver}'
-import * as schema from './db/schema.mjs'
-
-let _db
-function getDb() {
-  if (!_db) {
-    const hyperdrive = process.env.${bindingName} || globalThis.__env__?.${bindingName} || globalThis.${bindingName}
+    drizzleOrmContent = generateLazyDbTemplate(
+      `import { drizzle } from 'drizzle-orm/${driver}'`,
+      `    const hyperdrive = process.env.${bindingName} || globalThis.__env__?.${bindingName} || globalThis.${bindingName}
     if (!hyperdrive) throw new Error('${bindingName} binding not found')
-    _db = drizzle({ connection: hyperdrive.connectionString, schema${modeOption}${casingOption} })
-  }
-  return _db
-}
-const db = new Proxy({}, { get(_, prop) { return getDb()[prop] } })
-export { db, schema }
-`;
+    _db = drizzle({ connection: hyperdrive.connectionString, schema${modeOption}${casingOption} })`
+    );
+  }
+  if (driver === "postgres-js" && !nuxt.options.dev && !hub.hosting.includes("cloudflare")) {
+    const urlExpr = connection.url ? `'${connection.url}'` : `process.env.POSTGRES_URL || process.env.POSTGRESQL_URL || process.env.DATABASE_URL`;
+    drizzleOrmContent = generateLazyDbTemplate(
+      `import { drizzle } from 'drizzle-orm/postgres-js'
+import postgres from 'postgres'`,
+      `    const url = ${urlExpr}
+    if (!url) throw new Error('DATABASE_URL, POSTGRES_URL, or POSTGRESQL_URL required')
+    const client = postgres(url, { onnotice: () => {} })
+    _db = drizzle({ client, schema${casingOption} })`
+    );
+  }
+  if (driver === "mysql2" && !hub.hosting.includes("cloudflare")) {
+    const uriExpr = connection.uri ? `'${connection.uri}'` : `process.env.MYSQL_URL || process.env.DATABASE_URL`;
+    drizzleOrmContent = generateLazyDbTemplate(
+      `import { drizzle } from 'drizzle-orm/mysql2'`,
+      `    const uri = ${uriExpr}
+    if (!uri) throw new Error('DATABASE_URL or MYSQL_URL required')
+    _db = drizzle({ connection: { uri }, schema${modeOption}${casingOption} })`
+    );
   }
   const databaseTemplate = addTemplate({
     filename: "hub/db.mjs",
@@ -537,6 +556,9 @@ export default defineConfig({
 function resolveKVConfig(hub) {
   if (!hub.kv) return false;
   if (typeof hub.kv === "object" && "driver" in hub.kv) {
+    if (hub.kv.driver === "cloudflare-kv-binding") {
+      return defu(hub.kv, { binding: "KV" });
+    }
     return hub.kv;
   }
   if (process.env.KV_REST_API_URL && process.env.KV_REST_API_TOKEN || process.env.UPSTASH_REDIS_REST_URL && process.env.UPSTASH_REDIS_REST_TOKEN) {
@@ -712,7 +734,7 @@ async function launchDrizzleStudio(nuxt, hub) {
     if (dialect === "postgresql") {
       if (driver === "pglite") {
         log$1.info(`Launching Drizzle Studio with PGlite...`);
-        const nitroDevUrl = `http://localhost:${nuxt.options.devServer.port || 3e3}`;
+        const nitroDevUrl = `${nuxt.options.devServer.https ? "https" : "http"}://localhost:${nuxt.options.devServer.port || 3e3}`;
         await fetch(`${nitroDevUrl}/api/_hub/db/launch-studio?port=${port}`, {
           method: "POST"
         });
@@ -748,7 +770,8 @@ function addDevToolsCustomTabs(nuxt, hub) {
       icon: "i-lucide-database",
       view: isReady && port ? {
         type: "iframe",
-        src: `https://local.drizzle.studio?port=${port}`
+        src: `https://local.drizzle.studio?port=${port}`,
+        permissions: ["local-network-access https://local.drizzle.studio"]
       } : {
         type: "launch",
         description: "Launch Drizzle Studio",
